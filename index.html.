<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å®æ™¯åœ£è¯æ ‘ AR + ä¸‹é›ª</title>
    <style>
        body { margin: 0; overflow: hidden; }
        model-viewer { width: 100%; height: 100vh; background: transparent; }
        #tip { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.6); color: white; padding: 10px 20px; border-radius: 10px; z-index: 10; font-size: 18px; }
        canvas { position: absolute; top: 0; left: 0; pointer-events: none; } /* é›ªèŠ±å åŠ å±‚ */
    </style>
    <!-- Google model-viewer for AR -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <!-- Three.js for snow particles -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <div id="tip">ç‚¹å‡»â€œARâ€æŒ‰é’®ï¼Œå¯¹å‡†åœ°æ¿/æ¡Œé¢æ”¾ç½®åœ£è¯æ ‘ï¼Œé›ªèŠ±ä¼šé£˜è½ï¼ğŸ„â„ï¸</div>

    <!-- AR åœ£è¯æ ‘ï¼ˆå…è´¹æ¨¡å‹ï¼Œæ”¯æŒçœŸå®å…‰å½±ï¼‰ -->
    <model-viewer 
        src="https://modelviewer.dev/shared-assets/models/ChristmasTree.glb"  <!-- å¯æ¢æ›´å¥½æ¨¡å‹ -->
        alt="åœ£è¯æ ‘ AR"
        ar 
        ar-modes="webxr scene-viewer quick-look"
        environment-image="neutral"
        shadow-intensity="1"
        camera-controls
        auto-rotate
        ios-src="https://modelviewer.dev/shared-assets/models/ChristmasTree.usdz">
    </model-viewer>

    <!-- ä¸‹é›ªç²’å­å åŠ ï¼ˆè¦†ç›–æ•´ä¸ªæ‘„åƒå¤´ç”»é¢ï¼‰ -->
    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
        camera.position.z = 5;
        const renderer = new THREE.WebGLRenderer({ alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // é›ªèŠ±ç²’å­
        const snowCount = 8000;
        const geometry = new THREE.BufferGeometry();
        const positions = new Float32Array(snowCount * 3);
        for (let i = 0; i < snowCount; i++) {
            positions[i*3] = (Math.random() - 0.5) * 20;
            positions[i*3+1] = Math.random() * 20;
            positions[i*3+2] = (Math.random() - 0.5) * 20;
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ color: 0xffffff, size: 0.15, transparent: true });
        const snow = new THREE.Points(geometry, material);
        scene.add(snow);

        function animate() {
            requestAnimationFrame(animate);
            snow.rotation.y += 0.001;
            const pos = snow.geometry.attributes.position.array;
            for (let i = 1; i < pos.length; i += 3) {
                pos[i] -= 0.02;
                if (pos[i] < -10) pos[i] = 10;
            }
            snow.geometry.attributes.position.needsUpdate = true;
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
